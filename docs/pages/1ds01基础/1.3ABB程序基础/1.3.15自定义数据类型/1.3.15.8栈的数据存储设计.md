# 1.3.15.8 栈的数据存储设计

栈作为一个数据结构，他也是要存储在计算机的内存里面的，ABB RAPID并没有对应的栈的数据结构也没有对应的函数，不过这个不重要，只要知道原理我们就可以自己编写一个。我们可以使用数组来作为栈的容器。

首先是设计数据的存储结构，我们就用数组来表示我们的栈，因为数据是线性存储的，而且编程人员可以通过下标随意的访问和修改。这就违背了我们先进后出的要求，我们就在这里定义一个数组，并且只能用编写的接口函数来访问和删除元素。这样就可以确保该数组不会被随意乱改动。

我们首先添加一个Module并定义一个数组：

```text
MODULE StackModule
     LOCAL PERS num BoxIndex:=1;
     CONST Box Box_Empty:=["Empy",0,0,0,""];
     LOCAL var Box boxStack{80};
ENDMODULE 
```

BoxIndex:用来记录目前堆栈里面的箱子的最顶端对的编号，编号从“1”开始，但是我这次为了代码的通用性没有使用，不过我依旧保留了这个变量。

“LOCAL“:来修饰变量就是说明该变量只能在当前模块可以访问，其他模块不能直接访问，如果需要访问需要调用当前模块的函数访问或者修改。

“Box_Empty“: 用来表示一个空箱子的变量在栈里面的表示形式，也是后来我程序中用来判断栈是存储的数据是否是空，应为默认数据里面的数值声明后都是由系统默认数值的，我就用这个常量来表示。

“CONST“:表示常量，不能被修改。

我们可以通过下面的表格9-2来简单介绍一下用Array来实现栈功能的思路：

| 1    | 2    | 3    | 4         | 5         | 6         | …         |
| ---- | ---- | ---- | --------- | --------- | --------- | --------- |
| BoxA | BoxB | BoxA | Box_Empty | Box_Empty | Box_Empty | Box_Empty |

表9-2

我们可以看到数组boxStack中前三个位置分别存储了BoxA，BoxB和BoxA表示已经由数据存储了，后面的全部用Box_Empty来表示是空的。这样我们只要按照栈的特性来访问和修改数组就是能实现一个完整的栈的入栈和出栈的功能。

首先我们要实现一个函数，如果我们现在需要往栈里面添加一个新的数据，我们首先按需要找到最近的一个空的位置。那就需要我们实现一个功能，就是判断是否是空位置或者是否是空箱子。我们就可以通过这个函数来判断某个位置是否是有箱子。

下面是第一段函数：

```text
FUNC Bool IsEmpyt(Box value)
     IF value=Box_Empty Then
         RETURN TRUE;   
     ELSE
         RETURN FALSE;
     ENDIF
ENDFUNC
```

上面的函数实现了判断一个箱子是否是空箱子的功能，如果输入的数据的结构体是和Box_Empty一样的，那说明这个位置没存储箱子。如果为空就返回“True”反之则返回“False”这个函数在整个的功能模块里面将多次被使用到。
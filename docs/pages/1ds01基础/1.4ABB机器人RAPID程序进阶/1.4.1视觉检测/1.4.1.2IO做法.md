# 1.4.1.2 IO做法

1.基础设置

与1.4.1.1中有一定的区别。

IO做法中，不需要设置IP地址及端口号，不需要更改TCP通信，不需要添加“串行数据输出”，不需要连接网线。

创建8个场景scene 1~scene 8。

scene 1：CPU形状

scene 2：集成电路形状

scene 3：电容形状

scene 4：三极管形状

scene 5：CPU颜色

scene 6：集成电路颜色

scene 7：电容颜色

scene 8：三极管颜色

IO做法中需要用到下列IO信号。

| 信号类型 | 名称 | 地址  | 功能             |
| -------- | ---- | ----- | ---------------- |
| DI       | cok  | 13    | 视觉检测结果反馈 |
| DO       | sa   | 15    | 场景确认         |
| GO       | cgo  | 11-14 | 场景切换         |
| DO       | ap   | 10    | 拍照             |

2.程序编写

以下为示例，仅供参考，仍可继续优化。

```
func num ccd(num a)
	d:=0;
	setgo cgo,a;发送场景号
	w 0.2;
	set sa;场景确认。必须先发场景号，然后必须发场景确认信号，否则场景跳转比较慢
	movel dw{5},vmax,z50,tool0;	
	movel dw{5},vmax,fine,tool0;移动到ccd上方
	set ap;拍照
	w 0.2;
	reset ap;复位拍照信号。必须要复位，否则不能再次拍照。
	reset sa;复位场景确认信号，必须要复位，否则下一次切换场景时比较慢。
	if cok=1 then如果形状检测结果为1（OK），则检测颜色
		setgo cgo,a+4;向后跳转4个场景，即为对应的颜色检测
		set sa;
		w 0.2;	
		set ap;	
		w 0.2;
		if cok=1 then 如果颜色检测结果为1（OK），则为A类
			d:=1;
		else		  如果颜色检测结果为0（NG），则为B类
			d:=2;
		endif
	else			  如果形状检测结果为0（NG），则为掺杂
		d:=3;
	endif
	reset ap;复位拍照，为下一次检测做准备
	reset sa;复位场景确认，为下一次检测做准备
	return d;反馈芯片检测结果d
endfunc
```

